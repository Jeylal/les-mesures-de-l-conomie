x0*(1+g)^t
}
x0 = 2
g = 0.03
t = 1:150
x = f(x0 = x0, g = g, t = t)
plot(x, type = "l")
#| echo: true
plot(x, type = "l")
#| echo: true
plot(log(x), type = "l")
#| echo: true
library(tidyverse) # la fonction lag() doit être importée avec le package tidyverse
g = log(x) - lag(log(x)) # lag() prend la valeur de x à t-1
# Ou bien avec diff() (difference):
g = diff(log(x))
#| echo: true
#| output-location: column
g = seq(from = -0.30, to = 0.30, by = 0.001)
`log(g+1)` = log(g+1)
df = tibble(g = g, `log(g+1)` = `log(g+1)`)
df %>%
ggplot(aes(x = g, y = g, color = "g"))+
geom_line()+
geom_line(aes(x = g, y = `log(g+1)`, color = "Log(1+g)"))+
theme_minimal()+
labs(x = "", y = "")
#| echo: true
#| output-location: column-fragment
library(maddison) # le package maddison permet d'importer des données de longue durée du PIB par habitant
library(tidyverse)
data <- subset(maddison,
year >= 1800 &
iso2c %in% c("FR", "US"))
data %>%
ggplot(aes(x = year, y = rgdpnapc, color = country)) +
geom_line()+
theme_minimal()+
labs(x = "",
y = "PIB par habitant (dollar US 2011)",
title = "Échelle normale (non-logarithmique)")
#| echo: true
#| output-location: column-fragment
data %>%
ggplot(aes(x = year, y = log(rgdpnapc), color = country)) +
geom_line()+
theme_minimal()+
labs(x = "",
y = "PIB par habitant (dollar US 2011)",
title = "Échelle logarithmique")
#| echo: true
#| output-location: column
library(readr)
macroch <- read_csv("data/macroch.csv")
macroch %>%
ggplot(aes(x = W_real, y = C_real))+
geom_point()+
theme_minimal()+
labs(x = "Rémunération des salariés (W)",
y = "Consommation (C)")
#| echo: true
#| output-location: default
library(kableExtra)
library(broom)
model = lm(data = macroch, # préciser le tableau dans lequel les variables sont présentes
formula = C_real ~ W_real) # la formule estimée doit prendre la forme Y ~ X
tidy(model) %>%
kable()
#| echo: true
#| output-location: column
data = augment(model)
data %>%
ggplot(aes(x = W_real, y = C_real, color = "Valeurs réelles observées"))+
geom_line()+
geom_line(aes(x = W_real, y = .fitted, color = "Valeurs prédites"))+
theme_minimal()+
labs(title = "C = 43 + 0.797W")
#| echo: true
#| output-location: column
library(performance)
diagnostic_plots = plot(check_model(model, panel = FALSE))
diagnostic_plots[[2]]
#| echo: true
library(performance)
diagnostic_plots[[3]]
#| echo: true
#| code-fold: true
#| code-summary: "Afficher le code"
library(ggcharts)
macroch$year = 1960:2022
data_rates = tibble(year = 1961:2022, rate_c = diff(log(macroch$C_real)), rate_w = diff(log(macroch$W_real)))
plot1 <-
macroch %>%
ggplot(aes(x = year, y = C_real, color = "Consommation (niveau)"))+
geom_line()+
geom_line(aes(x = year, y = W_real, color = "Revenu des salariés (niveau)"))+
theme_minimal()+
labs(title = "Séries non stationnaires")+
theme(legend.position = "top")
plot2 <-
data_rates %>%
ggplot(aes(x = year, y = rate_c, color = "Consommation (taux de croissance)"))+
geom_line()+
labs(title = "Série stationnaire")+
theme_minimal()+
theme(legend.position = "top")
cowplot::plot_grid(plot1, plot2)
#| echo: true
#| code-fold: true
#| code-summary: "Afficher le code"
model3 = lm(data = data_rates,
rate_c ~ rate_w)
tidy(model3)
View(data)
data <-
data %>%
mutate(
year = 1960:2022
)
model4 = lm(data = data,
log(c_real) ~ year)
model4 = lm(data = data,
log(C_real) ~ year)
tidy(model4)
last(data$C_real)
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
model4 = lm(data = data,
log(C_real) ~ log(year))
tidy(model4)
model4 = lm(data = data,
log(C_real) ~ year)
tidy(model4)
model4 = lm(data = data,
log(C_real) ~ year-1)
tidy(model4)
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
mean(diff(log(data$C_real)))
mean(diff(log(data$C_real)))
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
model4 = lm(data = data,
C_real ~ year)
tidy(model4)
model4 = lm(data = data,
C_real ~ year-1)
tidy(model4)
mean(diff(log(data$C_real)))
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
mean(diff(log(data$C_real)))
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
mean(diff(log(data$C_real)))
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
model4 = lm(data = data,
C_real ~ factor(year))
tidy(model4)
model4 = lm(data = data,
C_real ~ factor(year)-1)
tidy(model4)
model4 = lm(data = data,
log(C_real) ~ year)
tidy(model4)
mean(diff(log(data$C_real)))
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
tidy(model4)
model4 = lm(data = data,
C_real ~ year)
tidy(model4)
model4 = lm(data = data,
log(C_real) ~ year)
tidy(model4)
exp(0.018)-1
exp(0.018)
model4 = lm(data = data,
log(C_real) ~ year)
tidy(model4)
data <-
data %>%
mutate(
year = 1960:2022,
year_centered = year - mean(year)
)
model4 = lm(data = data,
log(C_real) ~ year_centered)
tidy(model4)
View(data)
model4 = lm(data = data,
C_real ~ year_centered)
tidy(model4)
model4 = lm(data = data,
log(C_real) ~ year_centered)
tidy(model4)
exp(0.01803793)-1
mean(diff(log(data$C_real)))
data$C_real
model4 = lm(data = data,
log(C_real) ~ year_centered)
tidy(model4)
mean(diff(log(data$C_real)))
(last(data$C_real)/first(data$C_real))^(1/length(data$C_real)) - 1
log(last(data$C_real)) - log(first(data$C_real))
(log(last(data$C_real)) - log(first(data$C_real)))/length(data$C_real)
#| echo: true
data <-
data %>%
mutate(
year = 1960:2022,
)
model4 = lm(data = data,
log(C_real) ~ year)
tidy(model4)
data <- data %>%
mutate(
year_centered = year - mean(year)
)
data <- data %>%
mutate(
year_centered = year - mean(year)
)
model5 = lm(data = data,
log(C_real) ~ year_centered)
tidy(model5)
mean(data$year)
#| echo: true
data <- data %>%
mutate(
year_centered = year - mean(year)
)
model5 = lm(data = data,
log(C_real) ~ year_centered)
tidy(model5)
model6 = lm(data = data,
log(C_real) ~ year + I(year>2000))
tidy(model6)
summary(model6)
model6 = lm(data = data,
log(C_real) ~ year*I(year>2000))
summary(model6)
model6 = lm(data = data,
log(C_real) ~ year*I(year>1992))
summary(model6)
model6 %>%
ggplot(aes(x = year, y = C_real))
plot2
model6 = lm(data = data,
log(C_real) ~ year*I(year>1980))
summary(model6)
model6 = lm(data = data,
log(C_real) ~ year*I(year>1980) + year*I(year>2000))
summary(model6)
model6 = lm(data = data,
log(C_real) ~ year*I(year>1980))
summary(model6)
-57+31.9
0.03-0.0161
tidy(model6)
plot2
plot2
plot2+
labs(title = "taux de croissance de C")+
geom_hline(aes(yintercept = 0.3))
plot2+
labs(title = "taux de croissance de C")+
geom_hline(aes(yintercept = 0.03))
plot2+
labs(title = "taux de croissance de C")+
geom_hline(aes(yintercept = 0.03, year = 1960:1980))
plot2+
labs(title = "taux de croissance de C")+
geom_hline(aes(yintercept = 0.03, year = 1980))
plot2+
labs(title = "taux de croissance de C")+
geom_segment(aes(xend = 1980))
plot2+
labs(title = "taux de croissance de C")+
geom_segment(aes(xend = 1980, yend = 0.03))
geom_segment(aes(xend = 1980, yend = c(0, 0.03))
plot2+
plot2+
labs(title = "taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03))
plot2+
labs(title = "taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")
plot2+
labs(title = "taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")+
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")
library(marginaleffects)
model6 %>%
plot_predictions(condition = "year")
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = c_real))
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = C_real))
geom_line(data = data, aes(x = year, y = log(C_real))9
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)))
model6 %>%
plot_predictions(condition = "year", alpha = 0.8)+
geom_line(data = data, aes(x = year, y = log(C_real)))
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)))
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 2)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.4)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("log(c) = -57 + 0.03year", x = 1965, y = 5.5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate(label = "log(c) = -57 + 0.03year", x = 1965, y = 5.5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1965, y = 5.5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1960, y = 4)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1970, y = 4)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1970, y = 5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1976, y = 5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1977, y = 5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1977, y = 5)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 2010, y = 5.5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1977, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year + 0.03year", x = 2010, y = 5.5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1977, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1977, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1977, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)
plot3 <-
plot2+
labs(title = "taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")+
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")
library(marginaleffects)
plot4 <-
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1977, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)
cowplot::plot_grid(plot3, plot4)
plot4 <-
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1980, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)+
labs(y = "log(c)")
cowplot::plot_grid(plot3, plot4)
plot3 <-
plot2+
labs(title = "",
y = "Taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")+
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")
library(marginaleffects)
plot4 <-
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1980, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)+
labs(y = "log(c)")
cowplot::plot_grid(plot3, plot4)
plot3 <-
plot2+
labs(title = "",
y = "Taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")+
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")+
annotate("text", x = 1965, y = 0.025, label = "taux de croissance moyen = 0.03")+
annotate("text", x = 2000, y = 0, label = "taux de croissance moyen = 0,0139")
library(marginaleffects)
plot4 <-
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1980, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)+
labs(y = "log(c)")
cowplot::plot_grid(plot3, plot4)
plot3 <-
plot2+
labs(title = "",
y = "Taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")+
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")+
annotate("text", x = 1965, y = 0.025, label = "taux de croissance moyen = 0.03")+
annotate("text", x = 2000, y = 0, label = "taux de croissance moyen = 0,0139", size = 0.3)
library(marginaleffects)
plot4 <-
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1980, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)+
labs(y = "log(c)")
cowplot::plot_grid(plot3, plot4)
plot3 <-
plot2+
labs(title = "",
y = "Taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")+
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")+
annotate("text", x = 1965, y = 0.025, label = "taux de croissance moyen = 0.03", size = 1)+
annotate("text", x = 2000, y = 0, label = "taux de croissance moyen = 0,0139", size = 1)
library(marginaleffects)
plot4 <-
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1980, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)+
labs(y = "log(c)")
cowplot::plot_grid(plot3, plot4)
plot3 <-
plot2+
labs(title = "",
y = "Taux de croissance de C")+
geom_segment(aes(x = 1960, xend = 1980, y = 0.03, yend = 0.03), color = "black")+
geom_segment(aes(x = 1981, xend = 2022, y = 0.0139, yend = 0.0139), color = "black")+
annotate("text", x = 1965, y = 0.025, label = "taux de croissance moyen = 0.03", size = 1.9)+
annotate("text", x = 2000, y = 0, label = "taux de croissance moyen = 0,0139", size = 1.9)
library(marginaleffects)
plot4 <-
model6 %>%
plot_predictions(condition = "year")+
geom_line(data = data, aes(x = year, y = log(C_real)), size = 1.2, color = "darkred")+
theme_minimal()+
geom_vline(xintercept = 1980, linetype = 2)+
annotate("text", label = "log(c) = -57 + 0.03year", x = 1980, y = 5)+
annotate("text", label = "log(c) = -25 -0.0139year", x = 2010, y = 5.5)+
labs(y = "log(c)")
cowplot::plot_grid(plot3, plot4)
